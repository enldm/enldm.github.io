<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/icon.png" type="image/x-icon">
    <link rel="shortcut icon" href="/icon.png" type="image/x-icon">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="å…¨å›½BanG Dream!åŒå¥½ä¼šåœ°å›¾">
    <meta name="apple-mobile-web-app-title" content="å…¨å›½BanG Dream!åŒå¥½ä¼šåœ°å›¾">
    <meta name="description" content="å…¨å›½BanG Dream!åŒå¥½ä¼šåœ°å›¾|å…¨å›½é‚¦é‚¦åœ°å›¾ â€” æ”¶å½•å…¨å›½åœ°åŸŸæ€§BanG Dream!ç²‰ä¸ç»„ç»‡ã€æ´»åŠ¨åœ°ç‚¹ä¸äº¤æµå¹³å°ã€‚">
    <meta name="msapplication-starturl" content="/">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#DB0054">
    <script defer src="https://cloud.umami.is/script.js"
        data-website-id="ad547ccf-627a-4293-a348-8ef6c860aa63"></script>
    <title>å…¨å›½BanG Dream!åŒå¥½ä¼šåœ°å›¾</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.0/echarts.min.js"></script>
    <!-- åŠ è½½ Turnstile JS -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <script defer src="/js/mouse-icon-effect.js"></script>
    <style>
        @font-face {
            font-family: 'ZhanKuKuaiLeTi';
            src: url('/ZhanKuKuaiLeTi.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        * {
            font-family: 'ZhanKuKuaiLeTi', 'Microsoft YaHei', Arial, sans-serif;
        }

        body {
            margin: 0;
            padding: 20px;
            background-image: url('https://bang-dream.com/img/top/kv-slide-loading-bg.png');
            background-repeat: repeat;
            background-attachment: fixed;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #DB0054;
            font-size: 36px;
            margin: 0 0 10px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            color: #DB0054;
            font-size: 18px;
            margin: 0;
        }

        #map {
            width: 100%;
            height: 50vh;
            max-height: 700px;
            min-height: 400px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(219, 0, 84, 0.15);
            backdrop-filter: blur(10px);
            position: relative;
        }

        /* æµ·å¤–æŒ‰é’®è¦†ç›–å±‚ - ç§»åŠ¨ç«¯å…¼å®¹ */
        .overseas-btn-overlay {
            position: absolute;
            top: 40px;
            left: 20px;
            width: 50px;
            height: 35px;
            z-index: 100;
            cursor: pointer;
        }

        /* æ¯›ç»ç’ƒæ‚¬æµ®çª—æ ·å¼ */
        .glass-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            padding: 30px;
            width: 80vw;
            max-width: 1200px;
            max-height: 80vh;
            overflow-y: auto;
            z-index: 10000;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .glass-modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -45%);
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        .glass-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(219, 0, 84, 0.2);
        }

        .glass-modal-title {
            color: #DB0054;
            font-size: 28px;
            margin: 0;
            font-weight: bold;
        }

        .glass-modal-close {
            background: rgba(219, 0, 84, 0.1);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 24px;
            cursor: pointer;
            color: #DB0054;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .glass-modal-close:hover {
            background: rgba(219, 0, 84, 0.2);
            transform: rotate(90deg);
        }

        .groups-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .group-tag {
            display: inline-flex;
            align-items: center;
            padding: 10px 20px;
            background: linear-gradient(135deg, rgba(219, 0, 84, 0.1), rgba(219, 0, 84, 0.05));
            border-radius: 50px;
            border: 2px solid rgba(219, 0, 84, 0.2);
            color: #DB0054;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            white-space: nowrap;
        }

        .group-tag:hover {
            background: linear-gradient(135deg, rgba(219, 0, 84, 0.2), rgba(219, 0, 84, 0.1));
            border-color: rgba(219, 0, 84, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(219, 0, 84, 0.2);
        }

        .group-tag.copied {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border-color: #4CAF50;
            color: white;
        }

        .group-tag.empty {
            background: rgba(200, 200, 200, 0.1);
            border-color: rgba(200, 200, 200, 0.3);
            color: #999;
            cursor: default;
        }

        .group-tag.empty:hover {
            transform: none;
            box-shadow: none;
        }

        /* é®ç½©å±‚ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            display: block;
        }

        /* ä¿¡æ¯é¢æ¿æ ·å¼ */
        .info-panel {
            margin-top: 20px;
            padding: 25px;
            background-color: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(219, 0, 84, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .info-panel p {
            color: #DB0054;
            font-size: 16px;
            margin: 10px 0;
            line-height: 1.8;
        }

        .info-panel a {
            color: #DB0054;
            text-decoration: none;
            border-bottom: 2px dotted rgba(219, 0, 84, 0.3);
            transition: all 0.3s ease;
        }

        .info-panel a:hover {
            border-bottom-style: solid;
            border-bottom-color: #DB0054;
        }

        /* æŠ•ç¨¿è¡¨å•æ ·å¼ */
        #contact-form {
            max-width: 600px;
            margin: 40px auto;
            padding: 30px;
            background-color: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(219, 0, 84, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        #contact-form h3 {
            color: #DB0054;
            font-size: 24px;
            margin-top: 0;
            margin-bottom: 20px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 15px;
        }

        #contact-form select,
        #contact-form input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(219, 0, 84, 0.2);
            border-radius: 12px;
            box-sizing: border-box;
            font-size: 16px;
            color: #333;
            background: rgba(255, 255, 255, 0.8);
            transition: border 0.3s ease;
            font-family: 'ZhanKuKuaiLeTi', 'Microsoft YaHei', Arial, sans-serif;
        }

        #contact-form select:focus,
        #contact-form input:focus {
            outline: none;
            border-color: #DB0054;
            background: rgba(255, 255, 255, 1);
        }

        #contact-form select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23DB0054' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            padding-right: 40px;
        }

        #contact-form button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #DB0054, #c0004a);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-family: 'ZhanKuKuaiLeTi', 'Microsoft YaHei', Arial, sans-serif;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(219, 0, 84, 0.3);
        }

        #contact-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(219, 0, 84, 0.4);
        }

        #contact-form button:active {
            transform: translateY(0);
        }

        .mouse-icon {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
        }

        /* å¤åˆ¶æç¤º */
        .copy-toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            font-size: 16px;
            z-index: 10001;
            opacity: 0;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .copy-toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>å…¨å›½BanG Dream!åŒå¥½ä¼šåœ°å›¾</h1>
            <p>ã‚­ãƒ©ã‚­ãƒ©ãƒ‰ã‚­ãƒ‰ã‚­</p>
        </div>

        <div id="map">
            <div class="overseas-btn-overlay" id="overseasBtn"></div>
        </div>


        <div class="info-panel" id="infoPanel2">
            <p>ğŸ”— <a
                    href="https://enldm.cyou/2025/10/%E5%85%A8%E5%9B%BD%E9%82%A6%E9%82%A6%E5%9C%B0%E5%9B%BE%E5%BC%80%E5%8F%91%E6%97%A5%E5%BF%97/">å¼€å‘&æ›´æ–°æ—¥å¿—</a>
            </p>
            <p>ğŸ”§ å·¥å…·å¤§å…¨ï¼š<a href="https://bestdori.com/">Bestdori</a> <a href="https://bang-dream.com/">BanG-Dreamå®˜ç½‘</a>
                <a href="https://game.bilibili.com/bangdream/exchange/">æ‰‹æ¸¸å…‘æ¢ç </a>
                <a href="https://enldm.cyou/pjskmap">å…¨å›½Project SekaiåŒå¥½ä¼šåœ°å›¾</a>
            </p>
            <p>âœ‰ï¸ æŠ•ç¨¿å‹˜è¯¯ï¼šåŠ å…¥Qç¾¤ 636949985 æˆ–å‘é€é‚®ä»¶è‡³ <a href="mailto:admin@enldm.cyou">admin@enldm.cyou</a></p>
            <p style="text-align: center;">â¤ ç‰¹åˆ«é¸£è°¢ï¼š<a href="https://seieya.ip-ddns.com/">@zkylin</a> <a
                    href="https://enldm.cyou">@enldm</a></p>
        </div>

        <div id="contact-form">
            <h3>åœ¨çº¿æŠ•ç¨¿</h3>
            <div class="form-group">
                <select id="submissionType">
                    <option value="">è¯·é€‰æ‹©æŠ•ç¨¿ç±»å‹</option>
                    <option value="åœ°åŒºå¤§ç¾¤">åœ°åŒºå¤§ç¾¤</option>
                    <option value="å­¦æ ¡">å­¦æ ¡</option>
                    <option value="å…¶ä»–">å…¶ä»–</option>
                </select>
            </div>
            <div class="form-group">
                <input type="text" id="locationName" placeholder="è¯·è¾“å…¥å®Œæ•´å­¦æ ¡/åŸå¸‚åç§°">
            </div>
            <div class="form-group">
                <input type="text" id="groupNumber" placeholder="è¯·è¾“å…¥æ­£ç¡®çš„ç¾¤å·">
            </div>
            <!-- Turnstile Widget -->
            <div style="display: flex; flex-direction: column; align-items: center; gap: 15px;">
                <div class="cf-turnstile" data-sitekey="0x4AAAAAAB7bLKDGHTTCmU9N" data-theme="light" data-size="normal">
                </div>
                <button onclick="submitMessage()">å‘é€æŠ•ç¨¿</button>
            </div>
        </div>
    </div>

    <!-- æ¯›ç»ç’ƒæ‚¬æµ®çª— -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal()"></div>
    <div class="glass-modal" id="glassModal">
        <div class="glass-modal-header">
            <h2 class="glass-modal-title" id="modalTitle">çœä»½åç§°</h2>
            <button class="glass-modal-close" onclick="closeModal()">Ã—</button>
        </div>
        <div class="groups-container" id="groupsContainer">
            <!-- ç¾¤å·æ ‡ç­¾å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
        </div>
    </div>

    <!-- å¤åˆ¶æç¤º -->
    <div class="copy-toast" id="copyToast">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼</div>

    <script>
        // é©¬å¡é¾™é…è‰²æ–¹æ¡ˆ - æŸ”å’Œçš„é¢œè‰²
        const macaronColors = [
            '#FFB7B2', // æŸ”å’Œç²‰
            '#B5EAD7', // è–„è·ç»¿
            '#C7CEEA', // è–°è¡£è‰ç´«
            '#FFDAC1', // æè‰²
            '#E2F0CB', // æ·¡ç»¿
            '#FFDFD3', // æ·¡æ¡ƒè‰²
            '#BFCED6', // æ·¡è“ç°
            '#F0E68C', // å¡å…¶è‰²
            '#DDA0DD', // æ¢…çº¢
            '#87CEEB', // å¤©è“
            '#F5DEB3', // å°éº¦è‰²
            '#FFB6C1', // æµ…ç²‰çº¢
            '#98FB98', // è‹ç»¿
            '#DDA0DD', // æ¢…çº¢
            '#FFDAB9', // æ¡ƒè‰²
            '#ADD8E6', // æ·¡è“
            '#F0FFF0', // èœœç“œè‰²
            '#FFE4E1', // è–„é›¾ç«ç‘°
            '#E6E6FA', // æ·¡ç´«
            '#FFF0F5', // æ·¡ç´«çº¢
            '#F0FFFF', // æ·¡é’
            '#FFFACD', // æŸ æª¬ç»¸è‰²
            '#FFE4B5', // é¹¿çš®è‰²
            '#E0FFFF', // æ·¡é’
            '#FFFAF0', // èŠ±å‰ç™½
            '#F5FFFA', // è–„è·å¥¶æ²¹
            '#FFFFE0', // æ·¡é»„
            '#FFF8DC', // ç‰ç±³ä¸è‰²
            '#FFEFD5', // æœ¨ç“œè‰²
            '#FFF5EE', // æµ·è´å£³è‰²
            '#FDF5E6'  // è€è•¾ä¸è‰²
        ];

        // çœä»½ç›¸é‚»å…³ç³»ï¼ˆç”¨äºç¡®ä¿ç›¸é‚»çœä»½é¢œè‰²ä¸åŒï¼‰
        const provinceAdjacency = {
            'é»‘é¾™æ±Ÿçœ': ['å‰æ—çœ', 'å†…è’™å¤è‡ªæ²»åŒº'],
            'å‰æ—çœ': ['é»‘é¾™æ±Ÿçœ', 'è¾½å®çœ', 'å†…è’™å¤è‡ªæ²»åŒº'],
            'è¾½å®çœ': ['å‰æ—çœ', 'æ²³åŒ—çœ', 'å†…è’™å¤è‡ªæ²»åŒº'],
            'å†…è’™å¤è‡ªæ²»åŒº': ['é»‘é¾™æ±Ÿçœ', 'å‰æ—çœ', 'è¾½å®çœ', 'æ²³åŒ—çœ', 'å±±è¥¿çœ', 'é™•è¥¿çœ', 'å®å¤å›æ—è‡ªæ²»åŒº', 'ç”˜è‚ƒçœ'],
            'æ²³åŒ—çœ': ['è¾½å®çœ', 'å†…è’™å¤è‡ªæ²»åŒº', 'å±±è¥¿çœ', 'åŒ—äº¬å¸‚', 'å¤©æ´¥å¸‚', 'å±±ä¸œçœ', 'æ²³å—çœ'],
            'åŒ—äº¬å¸‚': ['æ²³åŒ—çœ', 'å¤©æ´¥å¸‚'],
            'å¤©æ´¥å¸‚': ['æ²³åŒ—çœ', 'åŒ—äº¬å¸‚', 'å±±ä¸œçœ'],
            'å±±è¥¿çœ': ['å†…è’™å¤è‡ªæ²»åŒº', 'æ²³åŒ—çœ', 'é™•è¥¿çœ', 'æ²³å—çœ'],
            'å±±ä¸œçœ': ['æ²³åŒ—çœ', 'å¤©æ´¥å¸‚', 'æ²³å—çœ', 'å®‰å¾½çœ', 'æ±Ÿè‹çœ'],
            'æ²³å—çœ': ['æ²³åŒ—çœ', 'å±±è¥¿çœ', 'é™•è¥¿çœ', 'æ¹–åŒ—çœ', 'å®‰å¾½çœ', 'å±±ä¸œçœ', 'æ±Ÿè‹çœ'],
            'é™•è¥¿çœ': ['å†…è’™å¤è‡ªæ²»åŒº', 'å±±è¥¿çœ', 'æ²³å—çœ', 'æ¹–åŒ—çœ', 'é‡åº†å¸‚', 'å››å·çœ', 'ç”˜è‚ƒçœ', 'å®å¤å›æ—è‡ªæ²»åŒº'],
            'ç”˜è‚ƒçœ': ['å†…è’™å¤è‡ªæ²»åŒº', 'å®å¤å›æ—è‡ªæ²»åŒº', 'é™•è¥¿çœ', 'å››å·çœ', 'é’æµ·çœ', 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº'],
            'å®å¤å›æ—è‡ªæ²»åŒº': ['å†…è’™å¤è‡ªæ²»åŒº', 'ç”˜è‚ƒçœ', 'é™•è¥¿çœ'],
            'é’æµ·çœ': ['ç”˜è‚ƒçœ', 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', 'å››å·çœ', 'è¥¿è—è‡ªæ²»åŒº'],
            'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº': ['ç”˜è‚ƒçœ', 'é’æµ·çœ', 'è¥¿è—è‡ªæ²»åŒº'],
            'è¥¿è—è‡ªæ²»åŒº': ['æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', 'é’æµ·çœ', 'å››å·çœ', 'äº‘å—çœ'],
            'å››å·çœ': ['é™•è¥¿çœ', 'ç”˜è‚ƒçœ', 'é’æµ·çœ', 'è¥¿è—è‡ªæ²»åŒº', 'äº‘å—çœ', 'è´µå·çœ', 'é‡åº†å¸‚', 'æ¹–åŒ—çœ', 'æ²³å—çœ'],
            'é‡åº†å¸‚': ['é™•è¥¿çœ', 'å››å·çœ', 'æ¹–åŒ—çœ', 'æ¹–å—çœ', 'è´µå·çœ'],
            'äº‘å—çœ': ['è¥¿è—è‡ªæ²»åŒº', 'å››å·çœ', 'è´µå·çœ', 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº'],
            'è´µå·çœ': ['å››å·çœ', 'é‡åº†å¸‚', 'äº‘å—çœ', 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'æ¹–å—çœ', 'æ¹–åŒ—çœ'],
            'æ¹–åŒ—çœ': ['æ²³å—çœ', 'é™•è¥¿çœ', 'é‡åº†å¸‚', 'æ¹–å—çœ', 'æ±Ÿè¥¿çœ', 'å®‰å¾½çœ', 'é‡åº†å¸‚'],
            'æ¹–å—çœ': ['æ¹–åŒ—çœ', 'é‡åº†å¸‚', 'è´µå·çœ', 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'å¹¿ä¸œçœ', 'æ±Ÿè¥¿çœ'],
            'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº': ['æ¹–å—çœ', 'è´µå·çœ', 'äº‘å—çœ', 'å¹¿ä¸œçœ'],
            'å¹¿ä¸œçœ': ['ç¦å»ºçœ', 'æ±Ÿè¥¿çœ', 'æ¹–å—çœ', 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'æµ·å—çœ', 'é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº', 'æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº'],
            'æµ·å—çœ': ['å¹¿ä¸œçœ'],
            'ç¦å»ºçœ': ['æµ™æ±Ÿçœ', 'æ±Ÿè¥¿çœ', 'å¹¿ä¸œçœ', 'å°æ¹¾çœ'],
            'æµ™æ±Ÿçœ': ['ä¸Šæµ·å¸‚', 'æ±Ÿè‹çœ', 'å®‰å¾½çœ', 'æ±Ÿè¥¿çœ', 'ç¦å»ºçœ'],
            'æ±Ÿè‹çœ': ['å±±ä¸œçœ', 'å®‰å¾½çœ', 'ä¸Šæµ·å¸‚', 'æµ™æ±Ÿçœ'],
            'ä¸Šæµ·å¸‚': ['æ±Ÿè‹çœ', 'æµ™æ±Ÿçœ'],
            'å®‰å¾½çœ': ['å±±ä¸œçœ', 'æ²³å—çœ', 'æ¹–åŒ—çœ', 'æ±Ÿè¥¿çœ', 'æµ™æ±Ÿçœ', 'æ±Ÿè‹çœ'],
            'æ±Ÿè¥¿çœ': ['å®‰å¾½çœ', 'æ¹–åŒ—çœ', 'æ¹–å—çœ', 'å¹¿ä¸œçœ', 'ç¦å»ºçœ', 'æµ™æ±Ÿçœ'],
            'å°æ¹¾çœ': ['ç¦å»ºçœ'],
            'é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº': ['å¹¿ä¸œçœ', 'æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº', 'å°æ¹¾çœ'],
            'æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº': ['å¹¿ä¸œçœ', 'é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº']
        };

        // ä¸ºçœä»½åˆ†é…é¢œè‰²ï¼ˆç¡®ä¿ç›¸é‚»çœä»½é¢œè‰²ä¸åŒï¼‰
        function assignProvinceColors() {
            const colors = {};
            const provinces = Object.keys(provinceAdjacency);

            for (const province of provinces) {
                const usedColors = new Set();
                // è·å–å·²åˆ†é…é¢œè‰²çš„ç›¸é‚»çœä»½
                const neighbors = provinceAdjacency[province] || [];
                neighbors.forEach(neighbor => {
                    if (colors[neighbor]) {
                        usedColors.add(colors[neighbor]);
                    }
                });

                // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªè¢«ä½¿ç”¨çš„é¢œè‰²
                for (const color of macaronColors) {
                    if (!usedColors.has(color)) {
                        colors[province] = color;
                        break;
                    }
                }

                // å¦‚æœæ‰€æœ‰é¢œè‰²éƒ½è¢«ä½¿ç”¨ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ª
                if (!colors[province]) {
                    colors[province] = macaronColors[Math.floor(Math.random() * macaronColors.length)];
                }
            }

            // ä¸ºæœªå®šä¹‰çš„çœä»½åˆ†é…éšæœºé¢œè‰²
            // ä½¿ç”¨çœä»½åç§°çš„å“ˆå¸Œå€¼æ¥ç¡®ä¿ä¸€è‡´æ€§
            const allProvinceNames = [
                'é»‘é¾™æ±Ÿçœ', 'å‰æ—çœ', 'è¾½å®çœ', 'å†…è’™å¤è‡ªæ²»åŒº', 'æ²³åŒ—çœ', 'åŒ—äº¬å¸‚', 'å¤©æ´¥å¸‚', 'å±±è¥¿çœ',
                'å±±ä¸œçœ', 'æ²³å—çœ', 'é™•è¥¿çœ', 'ç”˜è‚ƒçœ', 'å®å¤å›æ—è‡ªæ²»åŒº', 'é’æµ·çœ', 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº',
                'è¥¿è—è‡ªæ²»åŒº', 'å››å·çœ', 'é‡åº†å¸‚', 'äº‘å—çœ', 'è´µå·çœ', 'æ¹–åŒ—çœ', 'æ¹–å—çœ', 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº',
                'å¹¿ä¸œçœ', 'æµ·å—çœ', 'ç¦å»ºçœ', 'æµ™æ±Ÿçœ', 'æ±Ÿè‹çœ', 'ä¸Šæµ·å¸‚', 'å®‰å¾½çœ', 'æ±Ÿè¥¿çœ', 'å°æ¹¾çœ',
                'é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº', 'æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº'
            ];

            allProvinceNames.forEach(province => {
                if (!colors[province]) {
                    let hash = 0;
                    for (let i = 0; i < province.length; i++) {
                        hash = province.charCodeAt(i) + ((hash << 5) - hash);
                    }
                    colors[province] = macaronColors[Math.abs(hash) % macaronColors.length];
                }
            });

            return colors;
        }

        const provinceColors = assignProvinceColors();

        // ä¸º ECharts åˆ›å»ºæ•°æ®æ•°ç»„
        function createMapData() {
            const data = [];
            for (const province in provinceColors) {
                data.push({
                    name: province,
                    itemStyle: {
                        areaColor: provinceColors[province]
                    }
                });
            }
            return data;
        }

        // åˆå§‹åŒ–ECharts
        const myChart = echarts.init(document.getElementById('map'));

        // åŠ è½½ä¸­å›½åœ°å›¾æ•°æ®å’Œçœä»½åŸå¸‚æ•°æ®
        Promise.all([
            fetch('mapdata.json').then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            }),
            fetch('banggroupinfo.json').then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
        ]).then(([mapData, provinceCities]) => {
            // æ³¨å†Œä¸­å›½åœ°å›¾
            echarts.registerMap('china', mapData);

            // é…ç½®åœ°å›¾é€‰é¡¹
            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: function (params) {
                        return params.name;
                    },
                    backgroundColor: 'rgba(255, 255, 255, 0.9)',
                    borderColor: '#DB0054',
                    borderWidth: 2,
                    textStyle: {
                        color: '#DB0054',
                        fontSize: 14
                    }
                },
                visualMap: {
                    show: false
                },
                series: [
                    {
                        name: 'çœä»½',
                        type: 'map',
                        map: 'china',
                        roam: true,
                        zoom: 1.6,
                        center: [105, 36],
                        data: createMapData(),
                        label: {
                            show: true,
                            fontSize: 14,
                            color: '#333',
                            fontWeight: 'bold',
                            formatter: function (params) {
                                let name = params.name;
                                name = name
                                    .replace(/ç‰¹åˆ«è¡Œæ”¿åŒº$/, '')
                                    .replace(/å£®æ—è‡ªæ²»åŒº$/, '')
                                    .replace(/ç»´å¾å°”è‡ªæ²»åŒº$/, '')
                                    .replace(/å›æ—è‡ªæ²»åŒº$/, '')
                                    .replace(/è‡ªæ²»åŒº$/, '')
                                    .replace(/çœ$/, '');
                                return name;
                            }
                        },
                        itemStyle: {
                            borderColor: '#ffffff',
                            borderWidth: 2,
                            opacity: 0.9
                        },
                        emphasis: {
                            itemStyle: {
                                areaColor: '#DB0054',
                                shadowBlur: 20,
                                shadowColor: 'rgba(219, 0, 84, 0.5)',
                                opacity: 1
                            },
                            label: {
                                show: true,
                                color: '#fff',
                                fontSize: 13,
                                fontWeight: 'bold'
                            }
                        }
                    }
                ],
                graphic: [
                    {
                        type: 'group',
                        left: '20px',
                        top: '40px',
                        name: 'btn-overseas',
                        silent: false,
                        children: [
                            {
                                type: 'rect',
                                shape: {
                                    width: 50,
                                    height: 35,
                                    r: 8,
                                },
                                style: {
                                    fill: '#DB0054',
                                },
                                cursor: 'pointer',
                                silent: false,
                            },
                            {
                                type: 'text',
                                style: {
                                    text: 'æµ·å¤–',
                                    fontSize: 14,
                                    fontWeight: 'bold',
                                    fill: '#fff',
                                    align: 'center',
                                    verticalAlign: 'middle',
                                    x: 25,
                                    y: 17,
                                    textAlign: 'center',
                                    verticalAlign: 'middle'
                                },
                                silent: false,
                            }
                        ]
                    }
                ]
            };

            // è®¾ç½®é…ç½®é¡¹
            myChart.setOption(option);

            // ç”¨äºé˜²æ­¢ç§»åŠ¨ç«¯ç‚¹å‡»ç©¿é€çš„æ ‡å¿—
            let modalJustOpened = false;
            let modalOpenTimer = null;

            // æ‰“å¼€æ¨¡æ€æ¡†
            function openModal(title, citiesList) {
                const modal = document.getElementById('glassModal');
                const overlay = document.getElementById('modalOverlay');
                const titleEl = document.getElementById('modalTitle');
                const container = document.getElementById('groupsContainer');

                titleEl.textContent = title;
                container.innerHTML = '';

                // è®¾ç½®æ ‡å¿—ï¼Œé˜²æ­¢ç‚¹å‡»ç©¿é€
                modalJustOpened = true;
                if (modalOpenTimer) clearTimeout(modalOpenTimer);
                modalOpenTimer = setTimeout(() => {
                    modalJustOpened = false;
                }, 300);

                if (Array.isArray(citiesList) && citiesList.length > 0) {
                    citiesList.forEach(city => {
                        const tag = document.createElement('div');
                        tag.className = 'group-tag';

                        // æ£€æŸ¥æ˜¯å¦åŒ…å«æ•°å­—
                        const numberMatch = city.match(/\d+/g);
                        const hasNumber = numberMatch && numberMatch.length > 0;

                        if (hasNumber) {
                            tag.textContent = city;
                            tag.onclick = (e) => {
                                // é˜²æ­¢æ¨¡æ€æ¡†åˆšæ‰“å¼€æ—¶è§¦å‘å¤åˆ¶
                                if (modalJustOpened) return;
                                copyToClipboard(city, tag);
                            };
                        } else {
                            tag.textContent = city;
                            tag.classList.add('empty');
                        }

                        container.appendChild(tag);
                    });
                } else {
                    container.innerHTML = '<div class="group-tag empty">æš‚æ— æ•°æ®</div>';
                }

                modal.classList.add('active');
                overlay.classList.add('active');
            }

            // å…³é—­æ¨¡æ€æ¡†
            function closeModal() {
                const modal = document.getElementById('glassModal');
                const overlay = document.getElementById('modalOverlay');
                modal.classList.remove('active');
                overlay.classList.remove('active');
            }

            // å¤åˆ¶åˆ°å‰ªè´´æ¿
            function copyToClipboard(text, element) {
                // æå–æ•°å­—
                const numbers = text.match(/\d+/g);
                if (numbers && numbers.length > 0) {
                    const numberToCopy = numbers[numbers.length - 1]; // å¤åˆ¶æœ€åä¸€ä¸ªæ•°å­—

                    navigator.clipboard.writeText(numberToCopy).then(() => {
                        // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçŠ¶æ€
                        element.classList.add('copied');
                        element.textContent = 'å·²å¤åˆ¶ï¼';

                        // æ˜¾ç¤ºæç¤º
                        const toast = document.getElementById('copyToast');
                        toast.classList.add('show');

                        setTimeout(() => {
                            element.classList.remove('copied');
                            element.textContent = text;
                            toast.classList.remove('show');
                        }, 1500);
                    }).catch(err => {
                        console.error('å¤åˆ¶å¤±è´¥:', err);
                        alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                    });
                }
            }

            // å°†å‡½æ•°æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸ
            window.closeModal = closeModal;

            // ä¸ºæµ·å¤–æŒ‰é’®è¦†ç›–å±‚æ·»åŠ ç‚¹å‡»äº‹ä»¶
            const overseasBtn = document.getElementById('overseasBtn');
            if (overseasBtn) {
                overseasBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const overseasData = provinceCities['æµ·å¤–'] || ['æš‚æ— æµ·å¤–æ•°æ®'];
                    openModal('ğŸŒ æµ·å¤–', overseasData);
                });
            }

            // æ·»åŠ åœ°å›¾çœä»½ç‚¹å‡»äº‹ä»¶
            myChart.on('click', function (params) {
                // çœä»½ç‚¹å‡»äº‹ä»¶
                const provinceName = params.name;
                const cities = provinceCities[provinceName] || ['æš‚æ— è¯¥çœæ•°æ®'];
                openModal(`ğŸ“ ${provinceName}`, cities);
            });

            // æ·»åŠ åŠ è½½å®Œæˆæç¤º
            console.log('åœ°å›¾æ•°æ®åŠ è½½æˆåŠŸï¼æŒ‰F12æ˜¯æƒ³çœ‹ä»€ä¹ˆï¼Ÿ');

        })
            .catch(error => {
                console.error('âš åœ°å›¾æ•°æ®åŠ è½½å¤±è´¥:', error);
                document.getElementById('infoPanel').innerHTML =
                    `<p style="color: #DB0054;">âš åœ°å›¾æ•°æ®åŠ è½½å¤±è´¥ï¼š${error.message}</p>
                     <p style="color: #DB0054;">è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>`;
            });

        // å¤„ç†çª—å£å¤§å°å˜åŒ–
        window.addEventListener('resize', function () {
            myChart.resize();
        });

        // åœ¨çº¿æŠ•ç¨¿
        async function submitMessage() {
            const submissionType = document.getElementById('submissionType').value.trim();
            const locationName = document.getElementById('locationName').value.trim();
            const groupNumber = document.getElementById('groupNumber').value.trim();
            const turnstileToken = window.turnstile?.getResponse();

            if (!submissionType) {
                alert('è¯·é€‰æ‹©æŠ•ç¨¿ç±»å‹');
                return;
            }

            if (!locationName) {
                alert('è¯·è¾“å…¥å®Œæ•´å­¦æ ¡/åŸå¸‚åç§°');
                return;
            }

            if (!groupNumber) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„ç¾¤å·');
                return;
            }

            if (!turnstileToken) {
                alert('è¯·å®ŒæˆäººæœºéªŒè¯');
                return;
            }

            const message = `ã€${submissionType}ã€‘${locationName} - ç¾¤å·ï¼š${groupNumber}`;

            const url = 'https://tgapi.enldm.cyou/';

            try {
                const res = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message,
                        'cf-turnstile-response': turnstileToken
                    })
                });

                const data = await res.json();

                if (data.success) {
                    alert('âœ… æŠ•ç¨¿å·²å‘é€ï¼æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼');
                    document.getElementById('submissionType').value = '';
                    document.getElementById('locationName').value = '';
                    document.getElementById('groupNumber').value = '';
                    window.turnstile.reset();
                } else {
                    alert('âŒ å‘é€å¤±è´¥ï¼š' + (data.error || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (err) {
                alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
                console.error(err);
            }
        }

        // ESCé”®å…³é—­æ¨¡æ€æ¡†
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>

</html>