<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <!-- <link rel="manifest" href="/manifest.json">-->
    <!-- <link rel="icon" href="/icon.png" type="image/x-icon">-->
    <!-- <link rel="shortcut icon" href="/icon.png" type="image/x-icon">-->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="å…¨å›½Project SekaiåŒå¥½ä¼šåœ°å›¾">
    <meta name="apple-mobile-web-app-title" content="å…¨å›½Project SekaiåŒå¥½ä¼šåœ°å›¾">
    <meta name="msapplication-starturl" content="/">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#00FFFF">
    <script defer src="https://cloud.umami.is/script.js"
        data-website-id="ad547ccf-627a-4293-a348-8ef6c860aa63"></script>
    <title>å…¨å›½Project SekaiåŒå¥½ä¼šåœ°å›¾</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.0/echarts.min.js"></script>
    <!-- åŠ è½½ Turnstile JS -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <!-- <script defer src="/js/mouse-icon-effect.js"></script> -->
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            /* background-image: url('https://bang-dream.com/img/top/kv-slide-loading-bg.png'); */
            background-repeat: repeat;
            background-attachment: fixed;
            /* å¯é€‰ï¼šè®©èƒŒæ™¯éšé¡µé¢æ»šåŠ¨ */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;

        }

        .header {
            text-align: center;
            margin-bottom: 20px;

        }

        #map {
            width: 100%;
            height: 40vh;
            max-height: 700px;
            min-height: 400px;
            background-color: rgba(255, 255, 255, 0);
            border-radius: 20px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
        }

        .info-panel {
            margin-top: 20px;
            padding: 20px;
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            background-color: rgba(255, 255, 255, 0);
        }

        .mouse-icon {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            /* transform-origin: center; */
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>å…¨å›½Project SekaiåŒå¥½ä¼šåœ°å›¾</h1>
        </div>

        <div id="map"></div>

        <div class="info-panel" id="infoPanel">
            <p>ç‚¹å‡»åœ°å›¾ä¸Šçš„çœä»½æ¿å—æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</p>
        </div>

        <div class="info-panel" id="infoPanel">
            <p>ğŸ”— <a
                    href="https://enldm.cyou/2025/10/%E5%85%A8%E5%9B%BD%E9%82%A6%E9%82%A6%E5%9C%B0%E5%9B%BE%E5%BC%80%E5%8F%91%E6%97%A5%E5%BF%97/">å¼€å‘&æ›´æ–°æ—¥å¿—</a>
            </p>
            <p>ğŸ”§ å·¥å…·å¤§å…¨ï¼š
            </p>
            <p>ğŸ“¢ æµ·å¤–ä»¥åŠå„åœ°é«˜æ ¡ç¾¤å·ä¹Ÿæ¥å—æŠ•ç¨¿ä¸­ï¼</p>
            <p>ğŸ’Š è¯·ä¸è¦ä¸¾åŠç½‘ç«™ï¼æ²¡å¤‡æ¡ˆæ³è¯·æ”¾è¿‡ï¼</p>
            <p>âœ‰ï¸ æŠ•ç¨¿å‹˜è¯¯ï¼šåŠ å…¥Qç¾¤ 636949985 æˆ–å‘é€é‚®ä»¶è‡³ <a href="mailto:admin@enldm.cyou">admin@enldm.cyou</a></p>
            <p style="text-align: center;">â¤ ç‰¹åˆ«é¸£è°¢ï¼š<a href="https://seieya.ip-ddns.com/">@zkylin</a> <a
                    href="https://enldm.cyou">@enldm</a></p>
        </div>

        <div id="contact-form"
            style="max-width: 500px; margin: 40px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
            <h3>åœ¨çº¿æŠ•ç¨¿</h3>
            <textarea id="msg" placeholder="è¯·è¾“å…¥æŠ•ç¨¿å†…å®¹ï¼Œè¯·åŒ…å«å…·ä½“åœ°åŒºä¿¡æ¯/é«˜æ ¡å…¨ç§°+ç¾¤å+æ­£ç¡®çš„ç¾¤å·ï¼Œæ­£å¸¸æƒ…å†µä¸€åˆ°ä¸¤å¤©å†…æ›´æ–°ã€‚" rows="4" style="
        width: 100%;
        padding: 12px;
        margin-bottom: 10px;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-sizing: border-box;
        font-size: 15px;
        color: #333;
        resize: vertical;
        transition: border 0.3s ease;
    "></textarea>
            <!-- Turnstile Widget -->
            <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                <div class="cf-turnstile" data-sitekey="0x4AAAAAAB7bLKDGHTTCmU9N" data-theme="light" data-size="normal">
                </div>
                <button onclick="submitMessage()"
                    style="padding: 10px 20px; background: #0088cc; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    å‘é€æŠ•ç¨¿
                </button>
            </div>


            <script>
                // åˆå§‹åŒ–ECharts
                const myChart = echarts.init(document.getElementById('map'));

                // è‡ªå®šä¹‰çœä»½åŸå¸‚æ•°æ®
                const provinceCities = {
                    "è¾½å®çœ": [

                    ],
                    "å‰æ—çœ": [

                    ],
                    "é»‘é¾™æ±Ÿçœ": [

                    ],
                    "å¹¿ä¸œçœ": [

                    ],
                    "å¹¿è¥¿å£®æ—è‡ªæ²»åŒº": [

                    ],
                    "æµ·å—çœ": [

                    ],
                    "æ²³å—çœ": [

                    ],
                    "æ¹–åŒ—çœ": [

                    ],
                    "æ¹–å—çœ": [

                    ],
                    "é’æµ·çœ": [

                    ],
                    "æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº": [

                    ],
                    "é™•è¥¿çœ": [

                    ],
                    "é‡åº†å¸‚": [

                    ],
                    "å››å·çœ": [

                    ],
                    "è´µå·çœ": [

                    ],
                    "äº‘å—çœ": [

                    ],
                    "å±±è¥¿çœ": [

                    ],
                    "åŒ—äº¬å¸‚": [

                    ],
                    "æ²³åŒ—çœ": [

                    ],
                    "å¤©æ´¥å¸‚": [

                    ],
                    "å±±ä¸œçœ": [

                    ],
                    "æµ™æ±Ÿçœ": [

                    ],
                    "å®‰å¾½çœ": [

                    ],
                    "æ±Ÿè‹çœ": [

                    ],
                    "ä¸Šæµ·å¸‚": [

                    ],
                    "æ±Ÿè¥¿çœ": [

                    ],
                    "ç¦å»ºçœ": [

                    ],
                    "å®å¤å›æ—è‡ªæ²»åŒº": [

                    ],
                    "ç”˜è‚ƒçœ": [

                    ],
                    "å†…è’™å¤è‡ªæ²»åŒº": [

                    ],
                    "é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº": [

                    ],
                    "æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº": [

                    ],
                    "å°æ¹¾çœ": [

                    ],
                    "æµ·å¤–": [

                    ]
                };

                // åŠ è½½ä¸­å›½åœ°å›¾æ•°æ®
                fetch('mapdata.json')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(data => {
                        // æ³¨å†Œä¸­å›½åœ°å›¾
                        echarts.registerMap('china', data);

                        // é…ç½®åœ°å›¾é€‰é¡¹
                        const option = {
                            title: {
                                text: 'ç‚¹å‡»çœä»½ä¸‹æ»‘æŸ¥çœ‹ç¾¤å·',
                                subtext: 'æ¬¢è¿æ”¶è—è½¬å‘åˆ†äº«æœ¬ç½‘ç«™',
                                left: 'center',
                                textStyle: {
                                    fontSize: 20,
                                    fontWeight: 'bold'
                                },
                                subtextStyle: {
                                    fontSize: 14,
                                    color: '#666'
                                }
                            },
                            tooltip: {
                                trigger: 'item',
                                formatter: function (params) {
                                    return params.name;
                                },
                                backgroundColor: 'rgba(255,255,255,0.9)',
                                borderColor: '#91d5ff',
                                borderWidth: 1,
                                textStyle: {
                                    color: '#333'
                                }
                            },
                            visualMap: {
                                show: false
                            },
                            series: [
                                {
                                    name: 'çœä»½',
                                    type: 'map',
                                    map: 'china',
                                    roam: true,  // å…è®¸ç¼©æ”¾å’Œå¹³ç§»
                                    zoom: 1.6,
                                    center: [105, 36],
                                    label: {
                                        show: true,
                                        fontSize: 15,
                                        color: '#333',
                                        fontWeight: 1300,
                                        formatter: function (params) {
                                            let name = params.name;
                                            // å»é™¤ç‰¹å®šåç¼€
                                            name = name
                                                .replace(/ç‰¹åˆ«è¡Œæ”¿åŒº$/, '')
                                                .replace(/å£®æ—è‡ªæ²»åŒº$/, 'çœ')
                                                .replace(/ç»´å¾å°”è‡ªæ²»åŒº$/, 'çœ')
                                                .replace(/å›æ—è‡ªæ²»åŒº$/, 'çœ')
                                                .replace(/è‡ªæ²»åŒº$/, '')
                                            return name;
                                        }
                                    },
                                    itemStyle: {
                                        areaColor: '#1AE6E6',
                                        borderColor: '#108A8A',
                                        borderWidth: 1.0
                                    },
                                    emphasis: {
                                        itemStyle: {
                                            areaColor: '#108A8A',
                                            shadowBlur: 20,
                                            shadowColor: 'rgba(0, 0, 0, 0.3)'
                                        },
                                        label: {
                                            show: true,
                                            color: '#fff',
                                            fontSize: 12,
                                            fontWeight: 35
                                        }
                                    }
                                }
                            ],
                            graphic: [
                                {
                                    type: 'group',
                                    left: '20px',
                                    top: '40px',
                                    name: 'btn-overseas',

                                    children: [
                                        {
                                            type: 'rect',
                                            shape: {
                                                width: 40,
                                                height: 30,
                                                r: 5,
                                            },
                                            style: {
                                                fill: '#5470c6',
                                            },
                                            key: 'overseas-btn',
                                            // é¼ æ ‡æ ·å¼
                                            cursor: 'pointer',

                                        },
                                        {
                                            type: 'text',
                                            style: {
                                                text: 'æµ·å¤–',
                                                fontSize: 12,
                                                fontWeight: 'bold',
                                                fill: '#fff',
                                                align: 'center',
                                                verticalAlign: 'middle',
                                                x: 20,
                                                y: 15,
                                                textAlign: 'center',
                                                verticalAlign: 'middle'
                                            },

                                        }
                                    ]
                                }
                            ]

                        };

                        // è®¾ç½®é…ç½®é¡¹
                        myChart.setOption(option);

                        // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                        // å°è£…ï¼šç»Ÿä¸€çš„ä¿¡æ¯é¢æ¿æ›´æ–°å‡½æ•°
                        function updateInfoPanel(title, citiesList) {
                            const infoPanel = document.getElementById('infoPanel');
                            if (!infoPanel) return;

                            const content = Array.isArray(citiesList) && citiesList.length > 0
                                ? citiesList.map(city => `
            <p style="
                padding: 4px 12px;
                border-radius: 4px;
                font-size: 20px;
                margin: 4px 0;
                background: #f0f7ff;
                color: #333;
                white-space: normal;
            ">${city}</p>
          `).join('')
                                : '<p style="color: #999; font-size: 18px;">æš‚æ— æ•°æ®</p>';

                            infoPanel.innerHTML = `
        <h1>${title}</h1>
        <h2><strong>ä¸‹å±åˆ—è¡¨ï¼š</strong></h2>
        <p style="margin-top: 10px;">
            ${content}
        </p>
    `;
                        }

                        // ECharts ç‚¹å‡»äº‹ä»¶ï¼ˆä¼˜åŒ–åï¼‰
                        myChart.on('click', function (params) {
                            // æƒ…å†µ1ï¼šç‚¹å‡»çš„æ˜¯â€œæµ·å¤–â€æŒ‰é’®
                            if (params.componentType === 'graphic') {
                                const overseasData = provinceCities['æµ·å¤–'] || ['æš‚æ— æµ·å¤–æ•°æ®'];
                                updateInfoPanel('ğŸŒ æµ·å¤–', overseasData);
                                return;
                            }

                            // æƒ…å†µ2ï¼šç‚¹å‡»çš„æ˜¯åœ°å›¾ä¸Šçš„çœä»½
                            const provinceName = params.name;
                            const cities = provinceCities[provinceName] || ['æš‚æ— è¯¥çœæ•°æ®'];

                            // ä½¿ç”¨ç»Ÿä¸€å‡½æ•°æ›´æ–°é¢æ¿
                            updateInfoPanel(`ğŸ“ ${provinceName}`, cities);
                        });

                        // æ·»åŠ åŠ è½½å®Œæˆæç¤º
                        console.log('åœ°å›¾æ•°æ®åŠ è½½æˆåŠŸï¼æŒ‰F12æ˜¯æƒ³çœ‹ä»€ä¹ˆï¼Ÿ');

                    })
                    .catch(error => {
                        console.error('âš åœ°å›¾æ•°æ®åŠ è½½å¤±è´¥:', error);
                        document.getElementById('infoPanel').innerHTML =
                            `<p style="color: red;">âš åœ°å›¾æ•°æ®åŠ è½½å¤±è´¥ï¼š${error.message}</p>
                     <p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>`;
                    });

                // å¤„ç†çª—å£å¤§å°å˜åŒ–
                window.addEventListener('resize', function () {
                    myChart.resize();
                });

                // åœ¨çº¿æŠ•ç¨¿
                async function submitMessage() {
                    const message = document.getElementById('msg').value.trim();
                    const turnstileToken = window.turnstile?.getResponse();

                    if (!message || message.length > 1000) {
                        alert('è¯·è¾“å…¥ 1-1000 å­—ç¬¦çš„æ¶ˆæ¯');
                        return;
                    }

                    if (!turnstileToken) {
                        alert('è¯·å®ŒæˆäººæœºéªŒè¯');
                        return;
                    }

                    const url = 'https://tgapi.enldm.cyou/'; // ä½ çš„ Worker åœ°å€

                    try {
                        const res = await fetch(url, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                message,
                                'cf-turnstile-response': turnstileToken
                            })
                        });

                        const data = await res.json();

                        if (data.success) {
                            alert('âœ… æ¶ˆæ¯å·²å‘é€ï¼');
                            document.getElementById('msg').value = '';
                            window.turnstile.reset(); // é‡ç½®éªŒè¯ç 
                        } else {
                            alert('âŒ å‘é€å¤±è´¥ï¼š' + (data.error || 'æœªçŸ¥é”™è¯¯'));
                        }
                    } catch (err) {
                        alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
                        console.error(err);
                    }
                }
            </script>
</body>

</html>